/*! Zenith v1.0.0-alpha.4 | MIT License | Â© 2022 Aleph1 Technologies Inc */
const z=function(){"use strict";let e=0;const t=new Map,o=Object.freeze({math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"}),n={},r=Object.freeze({}),s=new Map,d=new Map,a=e=>{const t=e.flat(1/0),o=t[0],n=null!=o&&"boolean"!=typeof o&&(2===o.type||4===o.type)&&"key"in o.attrs;for(const[e,o]of t.entries())if(null==o||"boolean"==typeof o)t[e]=null;else if((2===o.type||4===o.type)&&n!=="key"in o.attrs)throw new Error("children must be keyed or keyless");return t},l=(e,t,o)=>{const r=e+":"+(t||"")+":"+(o||"");return(n[r]||(n[r]=t?document.createElementNS(t,e,o?{is:o}:null):document.createElement(e,o?{is:o}:null))).cloneNode()},m=(e,t,o,n,r)=>{if(e.children[n]=t,null!=o&&null!=o.dom){const n=t.type;if(n===o.type)switch(n){case 2:if(t.tag!==o.tag){const n=4===e.type?e.doms.indexOf(o.dom):-1;u(e,t,r),o.dom.replaceWith(t.dom),N(e,o),-1!==n&&(e.doms[n]=t.dom)}else t.dom=o.dom,y(e,t,o,r);break;case 3:t.dom=o.dom,t.tag!==o.tag&&t.dom.replaceWith(t.dom=document.createTextNode(t.tag));break;case 4:t.tag!==o.tag?(N(e,o),u(e,t,r)):(t.dom=o.dom,t.doms=o.doms,t.children=o.children,v(e,t,r));break;case 5:t.tag!==o.tag?(N(e,o),u(e,t,r)):(t.dom=o.dom,t.doms=o.doms)}else N(e,o),u(e,t,r)}else u(e,t,r)},i=(e,t,o,n)=>{const r=t.length,s=o.length;if(r>0)if(s>0){let d;const a=[],l=t[0]&&t[0].attrs&&null!=t[0].attrs.key,i=o[0]&&o[0].attrs&&null!=o[0].attrs.key;if(l&&i){const r={},s={};for(const e of t)r[e.attrs.key]=!0;for(const t of o){const o=t.attrs.key;r[o]?s[o]=t:(N(e,t),delete s[o])}let d=0;for(const o of t)null!=o&&(m(e,o,s[o.attrs.key],d,n),a.push(o.dom),o.dom.remove()),d++;f(e.dom,a)}else{const a=new Set;for(let n=r;n<s;n++)d=o[n],N(e,d),!0===d.removing&&(d.parent=e,t[n]=d);for(let s=0;s<r;s++)d=o[s],null==t[s]&&null!=d?(N(e,d),!0===d.removing&&(d.parent=e,t[s]=d,t[s]&&a.add(t[s].dom))):null==d||null==d.dom||a.has(d.dom)?(u(e,t[s],n),t[s]&&a.add(t[s].dom)):null==d.removing&&(m(e,t[s],d,s,n),t[s]&&a.add(t[s].dom))}}else c(e,t,0,r,n);else k(e,o,0,s);e.children=t},c=(e,t,o,n,r)=>{for(;o<n;)u(e,t[o++],r)},f=(e,t)=>{for(const o of t)o&&e.appendChild(o)},u=(e,t,o)=>{if(null!=t)switch(t.parent=e,t.type){case 2:h(e,t,o);break;case 3:t.dom=document.createTextNode(t.tag),f(e.dom,[t.dom]);break;case 4:w(e,t,o);break;case 5:g(e,t,o)}},g=(e,t,o)=>{const n=l(e.dom.nodeName,o);n.innerHTML=t.tag,t.doms=[...n.childNodes],t.dom=t.doms[0],f(e.dom,t.doms)},p=(e,t,o,n,r)=>{if(null!=o&&"type"!==t&&"key"!==t&&"is"!==t&&"ns"!==t)if("class"===t)e.dom.setAttribute(t,Array.isArray(o)?o.join(" "):o);else if("style"===t)if("string"==typeof o)e.dom.setAttribute(t,o);else for(const t in o)e.dom.style[t]=o[t];else"value"===t?"input"!==e.tag&&"option"!==e.tag&&"textarea"!==e.tag||(e.dom.value=o+""):"boolean"==typeof o?!0===o?e.dom.setAttribute(t,t):e.dom.removeAttribute(t):"o"===t[0]&&"n"===t[1]?e.events[t]=e.dom[t]=o:e.dom.setAttribute(t,o)},h=(e,t,n)=>{t.events={},t.dom=l(t.tag,n=((e,t)=>e.attrs&&e.attrs.xmlns||o[e.tag]||t)(t,t.attrs.ns||n),t.attrs.is),t.attrs.tick&&d.set(t,t.attrs.tick),"input"===t.tag&&null!=t.attrs.type&&t.dom.setAttribute("type",t.attrs.type);for(const e in t.attrs)p(t,e,t.attrs[e]);c(t,t.children,0,t.children.length,n),f(e.dom,[t.dom])},y=(e,t,o,n)=>{t.events=o.events,"input"===t.tag&&null!=t.attrs.type&&t.dom.setAttribute("type",t.attrs.type);for(const e in o.attrs)"o"===e[0]&&"n"===e[1]?t.events[e]=t.dom[e]=null:"type"!==e&&t.dom.removeAttribute(e);for(const e in t.attrs)p(t,e,t.attrs[e],o.attrs[e]);i(t,t.children,o.children,n)},b=(e,t)=>{t.children,v(e,t);let o=t.doms.length>0;for(const e of t.doms)if(e.parentNode){o=!1;break}o&&(t.doms=[...t.dom.childNodes],t.dom=t.doms[0],f(e.dom,t.doms))},w=(e,t,o)=>{t.tag.init&&t.tag.init(t),t.dom=l(e.dom.nodeName,o),t.children=j(t,t.tag.draw),c(t,t.children,0,t.children.length,o),t.doms=[...t.dom.childNodes],t.dom=t.doms[0],f(e.dom,t.doms),t.tag.tick&&d.set(t,t.tag.tick),t.tag.drawn&&t.tag.drawn(t)},v=(e,t,o)=>{t.dom=l(e.dom.nodeName,o),i(t,j(t,t.tag.draw,t.children),t.children,o||t.dom.namespaceURI),t.tag.drawn&&t.tag.drawn(t)},k=(e,t,o,n,r)=>{for(;o<n;)N(e,t[o++],r)},A=e=>{if(4===e.type&&(e.tag.destroy&&e.tag.destroy(e),e.removing=null),e.children?(k(e,e.children,0,e.children.length,!0),e.children.length=0):e.dom&&e.dom.remove&&e.dom.remove(),e.doms)for(const t of e.doms)t.remove();else e.dom&&e.dom.remove&&e.dom.remove();delete e.dom,e.parent=null},N=(e,t,o)=>{if(null!=t){switch(t.type){case 2:t.attrs.tick&&d.delete(t);break;case 4:if(t.tag.tick&&d.delete(t),!0===t.removing)return;if(!0!==o&&"function"==typeof t.tag.remove){const e=t.tag.remove(t);if(null!=e&&"function"==typeof e.then){t.removing=!0;const o=()=>{t.removing=!1,t.parent.children.splice(t.parent.children.indexOf(t),1),A(t)};return void e.then(o,o)}}break;case 5:for(const e in t.doms)t.doms[e].remove()}A(t)}},j=(e,t,o)=>{const n=t(e,o);return a(Array.isArray(n)?n:[n])},O=(e,...t)=>{const o=[];let n=0,s=t[n];for(!s||"object"!=typeof s||null!=s.tag||Array.isArray(s)?s=r:(s=Object.freeze(Object.assign({},s)),n++);n<t.length;){const e=t[n++];o.push(null!=e&&"object"==typeof e?e:null)}return{type:2,tag:e,attrs:s,children:a(o)}},x=(e,t)=>s.set(t,[e]),E=()=>{e++;for(const[e,t]of s)4===e.type&&b(t[0],e);s.clear();for(const[t,o]of d)o(t,e);requestAnimationFrame(E)};E();return{elem:O,text:e=>{const t=typeof e;return{type:3,tag:"string"===t||"number"===t||"bigint"===t?e+"":""}},comp:(e,t)=>{const o={type:4,tag:e,redraw:e=>((e,t)=>{t?b(e.parent,e):x(e.parent,e)})(o,e),attrs:t?Object.freeze(t):r};return o},html:e=>{const t=typeof e;return{type:5,tag:"string"===t||"number"===t||"bigint"===t?e+"":""}},compDef:e=>{if("function"!=typeof e.draw)throw new Error("compDef requires draw function");return Object.assign({},e,{type:1})},mount:(e,n)=>{if(null==e)throw new Error("dom must be an Element");let r=e.parentNode;for(;r;){if(t.get(r))throw new Error("dom ancestor is already drawn");r=r.parentNode}const s=t.get(e)||t.set(e,Object.assign(O(e.nodeName.toLowerCase()),{dom:e})).get(e);return null==n||0===n.length?(k(s,s.children,0,s.children.length),s.children.length=0):i(s,a(Array.isArray(n)?n:[n]),s.children,(e=>e.closest(o[(e.closest("math,svg")||e).nodeName.toLowerCase()]))(e)),s},type:Object.freeze({none:0,compDef:1,elem:2,text:3,comp:4,html:5}),ns:o}}();